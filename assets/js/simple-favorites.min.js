jQuery(function(t){function a(){t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavoritesnonce"},success:function(t){i(t.nonce)}})}function i(a){var i='<script type="text/javascript"> var simple_favorites_nonce = "'+a+'" ;</script>';t("head").append(i)}function e(){t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavorites_array"},success:function(a){var i=[];t.each(a.favorites,function(t,a){i[t]=a}),s(i)}})}function s(a){var i=t(".simplefavorite-button");t.each(i,function(i){for(var e=t(this).data("postid"),s=t(this).data("siteid"),r=t(this).data("favoritecount"),c="",i=0;i<a.length;i++)a[i].site_id===s&&(n(e,a[i].site_favorites)?(c=o(simple_favorites.favorited,r),t(this).addClass("active").html(c)):(c=o(simple_favorites.favorite,r),t(this).removeClass("active").html(c)),t(this).removeClass("loading"))})}function o(t,a){return"1"===simple_favorites.includecount&&(t+=' <span class="simplefavorite-button-count">'+a+"<span>"),t}function n(a,i){var e=!1;return t.each(i,function(t,i){i===a&&(e=!0),parseInt(i)===a&&(e=!0)}),e}function r(){var a=t(".favorites-list");t.each(a,function(){t(this).data("userid"),t(this).data("siteid"),t(this).data("links"),t(this)})}function c(a){var i=t(a).data("postid"),e=t(a).data("siteid"),s=parseInt(t(a).attr("data-favoritecount")),n="inactive",r="",c="";t(a).hasClass("active")?(t(a).removeClass("active"),0>s-1&&(s=1),t(a).attr("data-favoritecount",s-1),c=o(simple_favorites.favorite,s-1),r=l(c,n),t(a).html(r)):(n="active",t(a).addClass("active"),t(a).attr("data-favoritecount",s+1),c=o(simple_favorites.favorited,s+1),r=l(c,n),t(a).html(r)),t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavorites",nonce:simple_favorites_nonce,postid:i,siteid:e,status:n},success:function(i){"success"!==i.status&&console.log(i.message),t(a).removeClass("loading"),t(a).html(c)}})}function l(t,a){return"1"!==simple_favorites.indicate_loading?t:"active"===a?simple_favorites.loading_text+simple_favorites.loading_image_active:simple_favorites.loading_text+simple_favorites.loading_image}t(document).ready(function(){a()}),t(document).ready(function(){e(),r()}),t(document).on("click",".simplefavorite-button",function(a){a.preventDefault();var i=t(this);t(this).addClass("loading"),c(i)})});